
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.2">
    
    
      
        <title>P6 databases - MPXJ</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f955dcd.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-7202224-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-read-a-primavera-p6-database" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MPXJ" class="md-header__button md-logo" aria-label="MPXJ" data-md-component="logo">
      
  <img src="../images/mpxj-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MPXJ
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              P6 databases
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/joniles/mpxj/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mpxj
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MPXJ" class="md-nav__button md-logo" aria-label="MPXJ" data-md-component="logo">
      
  <img src="../images/mpxj-white.svg" alt="logo">

    </a>
    MPXJ
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/joniles/mpxj/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mpxj
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        Changes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-start/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-build/" class="md-nav__link">
        Building MPXJ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-dotnet/" class="md-nav__link">
        MPXJ and .Net
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-com/" class="md-nav__link">
        MPXJ and COM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-convert/" class="md-nav__link">
        Converting Files
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        How to Read...
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="How to Read..." data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          How to Read...
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-mpx/" class="md-nav__link">
        MPX Files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-mpp/" class="md-nav__link">
        MPP files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-mspdi/" class="md-nav__link">
        MSPDI files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-mpd/" class="md-nav__link">
        MPD files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-planner/" class="md-nav__link">
        Planner files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-asta/" class="md-nav__link">
        Asta files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-p3/" class="md-nav__link">
        P3 files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-suretrak/" class="md-nav__link">
        SureTrak files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-turboproject/" class="md-nav__link">
        TurboProject files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-projectlibre/" class="md-nav__link">
        ProjectLibre files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-fasttrack/" class="md-nav__link">
        FastTrack files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-ganttproject/" class="md-nav__link">
        GanttProject files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-phoenix/" class="md-nav__link">
        Phoenix files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-pmxml/" class="md-nav__link">
        PMXML files
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          P6 databases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        P6 databases
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-read-a-primavera-p6-database" class="md-nav__link">
    How To: Read a Primavera P6 database
  </a>
  
    <nav class="md-nav" aria-label="How To: Read a Primavera P6 database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    Java
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net" class="md-nav__link">
    .Net
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-primaveradatabasereader" class="md-nav__link">
    Using PrimaveraDatabaseReader
  </a>
  
    <nav class="md-nav" aria-label="Using PrimaveraDatabaseReader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#activity-wbs" class="md-nav__link">
    Activity WBS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wbs-is-full-path" class="md-nav__link">
    WBS is Full Path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-defined-fields" class="md-nav__link">
    User Defined Fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reading-additional-attributes" class="md-nav__link">
    Reading Additional Attributes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-xer/" class="md-nav__link">
        XER files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-merlin/" class="md-nav__link">
        Merlin files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-conceptdraw/" class="md-nav__link">
        ConceptDraw PROJECT files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-synchro/" class="md-nav__link">
        Synchro Scheduler files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-ganttdesigner/" class="md-nav__link">
        Gantt Designer files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-sdef/" class="md-nav__link">
        SDEF files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-schedule-grid/" class="md-nav__link">
        Schedule Grid files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-read-projectcommander/" class="md-nav__link">
        Project Commander files
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        How to Write...
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="How to Write..." data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          How to Write...
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-write-mpx/" class="md-nav__link">
        MPX files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../howto-write-mspdi/" class="md-nav__link">
        MSPDI files
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Field Guides...
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Field Guides..." data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Field Guides...
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../field-guide/" class="md-nav__link">
        Field Guide
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../mpp-field-guide/" class="md-nav__link">
        MPP Field Guide
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../users/" class="md-nav__link">
        Users
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../maven-reports/" class="md-nav__link">
        Maven Reports
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-read-a-primavera-p6-database" class="md-nav__link">
    How To: Read a Primavera P6 database
  </a>
  
    <nav class="md-nav" aria-label="How To: Read a Primavera P6 database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    Java
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net" class="md-nav__link">
    .Net
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-primaveradatabasereader" class="md-nav__link">
    Using PrimaveraDatabaseReader
  </a>
  
    <nav class="md-nav" aria-label="Using PrimaveraDatabaseReader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#activity-wbs" class="md-nav__link">
    Activity WBS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wbs-is-full-path" class="md-nav__link">
    WBS is Full Path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-defined-fields" class="md-nav__link">
    User Defined Fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reading-additional-attributes" class="md-nav__link">
    Reading Additional Attributes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/joniles/mpxj/edit/master/docs/howto-read-primavera.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>P6 databases</h1>
                
                <h2 id="how-to-read-a-primavera-p6-database">How To: Read a Primavera P6 database</h2>
<p>Reading from a Primavera database is a slightly different proposition
to reading file-based project data, as a database connection is required.</p>
<h3 id="java">Java</h3>
<p>The example below illustrates how to do this for a Primavera database
hosted in SQL Server, using the open source JTDS JDBC driver. 
The only difference when reading from an Oracle
database will be the JDBC driver and connection string used.</p>
<div class="highlight"><pre><span></span><code>import java.sql.Connection;
import java.sql.DriverManager;
import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.primavera.PrimaveraDatabaseReader;

...

//
// Load the JDBC driver
//
String driverClass=&quot;net.sourceforge.jtds.jdbc.Driver&quot;;
Class.forName(driverClass);

//
// Open a database connection. You will need to change
// these details to match the name of your server, database, user and password.
//
String connectionString=&quot;jdbc:jtds:sqlserver://localhost/PMDB;user=pmdb;password=pmdb&quot;;
Connection c = DriverManager.getConnection(connectionString);
PrimaveraDatabaseReader reader = new PrimaveraDatabaseReader();
reader.setConnection(c);

//
// Retrieve a list of the projects available in the database
//
Map&lt;Integer,String&gt; projects = reader.listProjects();

//
// At this point you&#39;ll select the project
// you want to work with.
//

//
// Now open the selected project using its ID
//
int selectedProjectID = 1;
reader.setProjectID(selectedProjectID);
ProjectFile projectFile = reader.read();
</code></pre></div>
<p>You can also connect to a standalone SQLite P6 database. This
is easier to achieve as a specific reader class has bee created
which manages the database connection for you:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">net.sf.mpxj.ProjectFile</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">net.sf.mpxj.primavera.PrimaveraDatabaseFileReader</span><span class="p">;</span>

<span class="p">...</span>

<span class="n">PrimaveraDatabaseFileReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrimaveraDatabaseFileReader</span><span class="p">();</span>

<span class="c1">//</span>
<span class="c1">// Retrieve a list of the projects available in the database</span>
<span class="c1">//</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="p">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">projects</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">listProjects</span><span class="p">(</span><span class="s">&quot;PPMDBSQLite.db&quot;</span><span class="p">);</span>

<span class="c1">//</span>
<span class="c1">// At this point you&#39;ll select the project</span>
<span class="c1">// you want to work with.</span>
<span class="c1">//</span>

<span class="c1">//</span>
<span class="c1">// Now open the selected project using its ID</span>
<span class="c1">//</span>
<span class="kt">int</span> <span class="n">selectedProjectID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">reader</span><span class="p">.</span><span class="na">setProjectID</span><span class="p">(</span><span class="n">selectedProjectID</span><span class="p">);</span>
<span class="n">ProjectFile</span> <span class="n">projectFile</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="s">&quot;PPMDBSQLite.db&quot;</span><span class="p">);</span>
</code></pre></div>
<h3 id="net">.Net</h3>
<p>The situation is a little more complicated when using the .Net version of MPXJ.
In this case you are still actually running Java code, so you need to use a JDBC
driver to establish a database connection.</p>
<p>Your first step will be to convert your JDBC driver to a .Net assembly using IKVM. For example
the command line below converts a version of Microsoft's SQL Server JDBC driver to a .Net
assembly:</p>
<div class="highlight"><pre><span></span><code>c:\java\ikvm-8.0.5449.1\bin\ikvmc.exe -out:mssql-jdbc-6.4.0.jre8.dll -target:library -keyfile:c:\java\mpxj\src.net\mpxj.snk -version:6.4.0.0 mssql-jdbc-6.4.0.jre8.jar
</code></pre></div>
<p>You can then add a reference to this assembly to your project. Configuring the JDBC driver
needs to be done in a slightly different way than you would using Java. Here we need to
create an instance of the JDBC driver class directly, rather than referencing it by name as we would in Java.</p>
<div class="highlight"><pre><span></span><code>//
// Configure the connection
//
var driver = new SQLServerDriver();
var connectionProperties = new Properties();
var connection = driver.connect(connectionString, connectionProperties);

//
// Configure the reader
//
var reader = new PrimaveraDatabaseReader();
reader.Connection = connection;
</code></pre></div>
<p>You can find the complete code for this <a href="https://github.com/joniles/mpxj/blob/master/src.net/MpxjPrimaveraConvert/MpxjPrimaveraConvert.cs">here</a>.</p>
<h3 id="using-primaveradatabasereader">Using PrimaveraDatabaseReader</h3>
<p>This section documents the additional options provided by the PrimaveraDatabaseReader.</p>
<h4 id="activity-wbs">Activity WBS</h4>
<p>In the original implementation of the database handling code, MPXJ would assign each task representing
a Primavera Activity its own distinct WBS value. This does not match Primavera's behaviour where
all of a WBS element's child activities will have the same WBS value as the parent WBS element.
MPXJ's default behaviour now matches Primavera, but should you wish to you can revert to the original
behaviour by calling the <code>setMatchPrimaveraWBS</code> as shown below.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">net.sf.mpxj.ProjectFile</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">net.sf.mpxj.primavera.PrimaveraDatabaseReader</span><span class="p">;</span>

<span class="p">...</span>

<span class="n">PrimaveraDatabaseReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrimaveraDatabaseReader</span><span class="p">();</span>
<span class="n">reader</span><span class="p">.</span><span class="na">setMatchPrimaveraWBS</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<h4 id="wbs-is-full-path">WBS is Full Path</h4>
<p>Currently the WBS attribute of summary tasks (WBS entities in P6) will be a dot
separated hierarchy of all of the parent WBS attributes.
In this example, <code>root.wbs1.wbs2</code> is the WBS attribute for <code>wbs2</code> which has
the parents <code>root</code> and <code>wbs1</code>. To disabled this behaviour, and simply record
the code for the current WBS entry (in the example above <code>wbs2</code>) call the
<code>setWbsIsFullPath</code> method, passing in <code>false</code>, as illustrated below.  </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">net.sf.mpxj.ProjectFile</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">net.sf.mpxj.primavera.PrimaveraDatabaseReader</span><span class="p">;</span>

<span class="p">...</span>

<span class="n">PrimaveraDatabaseReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrimaveraDatabaseReader</span><span class="p">();</span>
<span class="n">reader</span><span class="p">.</span><span class="na">setWbsIsFullPath</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<h4 id="user-defined-fields">User Defined Fields</h4>
<p>MPXJ attempts to map user defined fields from P6 to the custom fields.
When MPXJ reads user defined fields from the database, it will assign
each new user defined field to a new custom attribute. For example when
the first custom text field is read, it will be stored in TEXT1, the next
custom text field will be stored in TEXT2, and so on.</p>
<p>It is possible that there are more user defined values in the database
than there are custom attributes of a specific type in the MPXJ data model.
For example the task entity only has TEXT to TEXT30 attributes, so if the database
has more than 30 text user defined attributes, the default mapping
switches to using ENTERPRISE_TEXT fields.</p>
<p>The list below shows the default mappings used by MPXJ. Where there is more than one item
shown for each user defined type, this indicates how MPXJ "overflows" from one
custom type to another.</p>
<ul>
<li>FT_TEXT: TEXT, ENTERPRISE_TEXT</li>
<li>FT_START_DATE: START</li>
<li>FT_END_DATE: FINISH</li>
<li>FT_FLOAT_2_DECIMALS: NUMBER, ENTERPRISE_NUMBER</li>
<li>FT_INT: NUMBER, ENTERPRISE_NUMBER</li>
<li>FT_STATICTYPE: TEXT, ENTERPRISE_TEXT</li>
<li>FT_MONEY: COST, ENTERPRISE_COST</li>
</ul>
<p>You can modify the default mappings used between P6 user defined fields and MPXJ
custom fields using the the methods shown in the code sample below:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">net.sf.mpxj.ProjectFile</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">net.sf.mpxj.primavera.PrimaveraDatabaseReader</span><span class="p">;</span>

<span class="p">...</span>

<span class="n">PrimaveraDatabaseReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrimaveraDatabaseReader</span><span class="p">();</span>
<span class="n">reader</span><span class="p">.</span><span class="na">setFieldNamesForTaskUdfType</span><span class="p">(</span><span class="n">UserFieldDataType</span><span class="p">.</span><span class="na">FT_TEXT</span><span class="p">,</span> <span class="s">&quot;ENTERPRISE_TEXT&quot;</span><span class="p">,</span> <span class="s">&quot;TEXT&quot;</span><span class="p">);</span>
<span class="n">reader</span><span class="p">.</span><span class="na">setFieldNamesForResourceUdfType</span><span class="p">(</span><span class="n">UserFieldDataType</span><span class="p">.</span><span class="na">FT_START_DATE</span><span class="p">,</span> <span class="s">&quot;DATE&quot;</span><span class="p">);</span>
<span class="n">reader</span><span class="p">.</span><span class="na">setFieldNamesForAssignmentUdfType</span><span class="p">(</span><span class="n">UserFieldDataType</span><span class="p">.</span><span class="na">FT_END_DATE</span><span class="p">,</span> <span class="s">&quot;DATE&quot;</span><span class="p">);</span>
</code></pre></div>
<p>As the sample shows, a method is provided for the three main entity types: tasks, resources
and resource assignments. The first argument you pass to these methods is the P6 user defined
field type, followed by a list of names, for example to use the fields DATE1, DATE2 and so on in MPXJ,
you would pass in <code>"DATE"</code>. To allow values to overflow from one custom field type
to another, you can simply pass additional values (see the <code>setFieldNamesForTaskUdfType</code> example above).</p>
<h4 id="reading-additional-attributes">Reading Additional Attributes</h4>
<p>A data-driven approach is used to extract the attributes used by MPXJ from the database.
You can if you wish change the way attributes are read from the file, or add support
for additional attributes. This assumes that you know the column name of the attributes
you want to work with in the database. To make changes you will need to retrieve the maps
which define which MPXJ attributes are used to store which columns from the database:</p>
<div class="highlight"><pre><span></span><code><span class="n">PrimaveraDatabaseReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrimaveraDatabaseReader</span><span class="p">();</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">FieldType</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">resourceFieldMap</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">getResourceFieldMap</span><span class="p">();</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">FieldType</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">wbsFieldMap</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">getWbsFieldMap</span><span class="p">();</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">FieldType</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">activityFieldMap</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">getActivityFieldMap</span><span class="p">();</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">FieldType</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">assignmentFieldMap</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="na">getAssignmentFieldMap</span><span class="p">();</span>
</code></pre></div>
<p>These maps will contain the default mapping between columns and MPXJ attributes. You can modify
these existing mappings, or add new ones, for example:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//</span>
<span class="c1">// Change the field used to store rsrc_id</span>
<span class="c1">//</span>
<span class="n">activityFieldMap</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">TaskField</span><span class="p">.</span><span class="na">NUMBER1</span><span class="p">);</span>
<span class="n">activityFieldMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">TaskField</span><span class="p">.</span><span class="na">NUMBER2</span><span class="p">,</span> <span class="s">&quot;rsrc_id&quot;</span><span class="p">);</span>

<span class="c1">//</span>
<span class="c1">// Read an Activity column called an_example_field and store it in TEXT10</span>
<span class="c1">//</span>
<span class="n">activityFieldMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">TaskField</span><span class="p">.</span><span class="na">TEXT10</span><span class="p">,</span> <span class="s">&quot;an_example_field&quot;</span><span class="p">);</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../howto-read-pmxml/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              PMXML files
            </div>
          </div>
        </a>
      
      
        <a href="../howto-read-xer/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              XER files
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>