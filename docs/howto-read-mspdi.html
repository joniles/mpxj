<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src\site\markdown/howto-read-mspdi.md
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>MPXJ &#x2013; How To: Read MSPDI files</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-7202224-1', 'auto');
      ga('send', 'pageview');
      ga('set', 'anonymizeIp', true);
      ga('set', 'forceSSL', true);
    </script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/joniles/mpxj">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>MPXJ</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2021-04-20</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span3">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">MPXJ</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a></li>
    <li><a href="changes-report.html" title="Changes"><span class="none"></span>Changes</a></li>
    <li><a href="getting-started.html" title="Getting started..."><span class="icon-chevron-right"></span>Getting started...</a></li>
    <li><a href="howto-read.html" title="How to read..."><span class="icon-chevron-down"></span>How to read...</a>
     <ul class="nav nav-list">
      <li><a href="howto-read-mpx.html" title="MPX files"><span class="none"></span>MPX files</a></li>
      <li><a href="howto-read-mpp.html" title="MPP files"><span class="none"></span>MPP files</a></li>
      <li class="active"><a href="#"><span class="none"></span>MSPDI files</a></li>
      <li><a href="howto-read-mpd.html" title="MPD files"><span class="none"></span>MPD files</a></li>
      <li><a href="howto-read-planner.html" title="Planner files"><span class="none"></span>Planner files</a></li>
      <li><a href="howto-read-asta.html" title="Asta files"><span class="none"></span>Asta files</a></li>
      <li><a href="howto-read-p3.html" title="P3 files"><span class="none"></span>P3 files</a></li>
      <li><a href="howto-read-suretrak.html" title="SureTrak files"><span class="none"></span>SureTrak files</a></li>
      <li><a href="howto-read-turboproject.html" title="TurboProject files"><span class="none"></span>TurboProject files</a></li>
      <li><a href="howto-read-projectlibre.html" title="ProjectLibre files"><span class="none"></span>ProjectLibre files</a></li>
      <li><a href="howto-read-fasttrack.html" title="FastTrack files"><span class="none"></span>FastTrack files</a></li>
      <li><a href="howto-read-ganttproject.html" title="GanttProject files"><span class="none"></span>GanttProject files</a></li>
      <li><a href="howto-read-phoenix.html" title="Phoenix files"><span class="none"></span>Phoenix files</a></li>
      <li><a href="howto-read-pmxml.html" title="PMXML files"><span class="none"></span>PMXML files</a></li>
      <li><a href="howto-read-primavera.html" title="P6 databases"><span class="none"></span>P6 databases</a></li>
      <li><a href="howto-read-xer.html" title="XER files"><span class="none"></span>XER files</a></li>
      <li><a href="howto-read-merlin.html" title="Merlin files"><span class="none"></span>Merlin files</a></li>
      <li><a href="howto-read-conceptdraw.html" title="ConceptDraw PROJECT files"><span class="none"></span>ConceptDraw PROJECT files</a></li>
      <li><a href="howto-read-synchro.html" title="Synchro Scheduler files"><span class="none"></span>Synchro Scheduler files</a></li>
      <li><a href="howto-read-ganttdesigner.html" title="Gantt Designer files"><span class="none"></span>Gantt Designer files</a></li>
      <li><a href="howto-read-sdef.html" title="SDEF files"><span class="none"></span>SDEF files</a></li>
      <li><a href="howto-read-schedule-grid.html" title="Schedule Grid files"><span class="none"></span>Schedule Grid files</a></li>
      <li><a href="howto-read-projectcommander.html" title="Project Commander files"><span class="none"></span>Project Commander files</a></li>
     </ul></li>
    <li><a href="howto-write.html" title="How to write..."><span class="icon-chevron-right"></span>How to write...</a></li>
    <li><a href="field-guide.html" title="Field Guide"><span class="none"></span>Field Guide</a></li>
    <li><a href="mpp-field-guide.html" title="MPP Field Guide"><span class="none"></span>MPP Field Guide</a></li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
    <li><a href="users.html" title="Users"><span class="none"></span>Users</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span9" >
<section>
<h2><a name="How_To:_Read_MSPDI_files"></a>How To: Read MSPDI files</h2>
<p>The Microsoft Project Data Interchange (MSPDI) format is an XML file format which Microsoft Project has been able to read and write since Project 2002.</p><section>
<h3><a name="Reading_MSPDI_files"></a>Reading MSPDI files</h3>
<p>The simplest way to read an MSPDI file is to use the <code>UniversalProjectReader</code>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.reader.UniversalProjectReader;

...

UniversalProjectReader reader = new UniversalProjectReader();
ProjectFile project = reader.read(&quot;my-sample.xml&quot;);
</pre></div></div>
</section><section>
<h3><a name="Using_MSPDIReader"></a>Using MSPDIReader</h3>
<p>You can work directly with the <code>MSPDIReader</code> class by replacing <code>UniversalProjectReader</code> with <code>MSPDIReader</code>. This provides access to additional options, as described below.</p><section>
<h4><a name="Encoding"></a>Encoding</h4>
<p>By default MPXJ assumes that MSPDI files are encoded as UTF-8. The <code>UniversalProjectReader</code> understands Unicode Byte Order Marks (BOM) and will adjust the encoding appropriately if a BOM is present. If you have an MSPDI file with an unusual encoding, you can manually set the encoding used by the reader.</p>
<p>Two methods are provided to do this: <code>setCharset</code> and <code>setEncoding</code>. The <code>setCharset</code> method takes an instance of the <code>Charset</code> class, while the <code>setEncoding</code> method takes the name of an encoding. Examples of these methods are shown below:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIReader;

...

MSPDIReader reader = new MSPDIReader();

// Use a Charset instance
reader.setCharset(Charset.forName(&quot;GB2312&quot;));
ProjectFile project = reader.read(&quot;my-sample.xml&quot;);

// Use an encoding name
reader.setEncoding(&quot;GB2312&quot;);
project = reader.read(&quot;my-sample.xml&quot;);
</pre></div></div>
</section><section>
<h4><a name="Microsoft_Project_Compatibility"></a>Microsoft Project Compatibility</h4>
<p>Microsoft Project will read MSPDI files which are not valid XML according to the MSPDI schema. By default MPXJ has been configured to take the same approach. If for some reason you wish to apply strict validation when reading an MSPDI file, you can do this using the <code>setMicrosoftProjectCompatibleInput</code> method, as shown below.</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIReader;

...

MSPDIReader reader = new MSPDIReader();
reader.setMicrosoftProjectCompatibleInput(false);
ProjectFile project = reader.read(&quot;my-sample.xml&quot;);
</pre></div></div></section></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2000&#x2013;2021
<a href="http://mpxj.org">Packwood Software</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
