<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src\site\markdown/howto-write-mspdi.md
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>MPXJ &#x2013; How To: Write MSPDI files</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-7202224-1', 'auto');
      ga('send', 'pageview');
      ga('set', 'anonymizeIp', true);
      ga('set', 'forceSSL', true);
    </script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/joniles/mpxj">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>MPXJ</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2021-04-20</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span3">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">MPXJ</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a></li>
    <li><a href="changes-report.html" title="Changes"><span class="none"></span>Changes</a></li>
    <li><a href="getting-started.html" title="Getting started..."><span class="icon-chevron-right"></span>Getting started...</a></li>
    <li><a href="howto-read.html" title="How to read..."><span class="icon-chevron-right"></span>How to read...</a></li>
    <li><a href="howto-write.html" title="How to write..."><span class="icon-chevron-down"></span>How to write...</a>
     <ul class="nav nav-list">
      <li><a href="howto-write-mpx.html" title="MPX files"><span class="none"></span>MPX files</a></li>
      <li class="active"><a href="#"><span class="none"></span>MSPDI files</a></li>
     </ul></li>
    <li><a href="field-guide.html" title="Field Guide"><span class="none"></span>Field Guide</a></li>
    <li><a href="mpp-field-guide.html" title="MPP Field Guide"><span class="none"></span>MPP Field Guide</a></li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
    <li><a href="users.html" title="Users"><span class="none"></span>Users</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span9" >
<section>
<h2><a name="How_To:_Write_MSPDI_files"></a>How To: Write MSPDI files</h2>
<p>Since Microsoft Project 2002, Microsoft Project has been able to read and write an XML-based data interchange format called MSPDI.</p><section>
<h3><a name="Writing_MSPDI_files"></a>Writing MSPDI files</h3>
<p>The sample code below illustrates how to write data to an MSPDI file.</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;

...

MSPDIWriter writer = new MSPDIWriter();
writer.write(projectFile, outputFileName);
</pre></div></div>
</section><section>
<h3><a name="Using_MSPDIWriter"></a>Using MSPDIWriter</h3><section>
<h4><a name="Microsoft_Project_Compatible_Output"></a>Microsoft Project Compatible Output</h4>
<p>Microsoft Project has a non-standard way of representing negative duration values (it should have a minus sign as a prefix at the start of the XSD duration expression rather than embedded in it).</p>
<p>Originally MPXJ read and wrote correctly formatted XSD duration values, but unfortunately this meant that  Project would not read these values correctly, and MPXJ would not be able to consume these values correctly from an MSPDI file written by Project. MPXJ has been updated so that it reads and writes the form of these duration values understood by Project, but this does mean that if you were previously expecting to be able to parse valid XSD duration values from output generated by MPXJ, that will no longer be the case.</p>
<p>To provide backward compatibility the <code>MicrosoftProjectCompatibleOutput</code> flag has been introduced. This defaults to <code>true</code> so MSPDI files containing negative durations written by MPXJ can be read by Project. If you need to produce correctly formatted XSD durations for consumption by applications other than Project you can set this flag to <code>false</code>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;
...

MSPDIWriter writer = new MSPDIWriter();
writer.setMicrosoftProjectCompatibleOutput(false);
writer.write(projectFile, outputFileName);
</pre></div></div>
</section><section>
<h4><a name="Save_Version"></a>Save Version</h4>
<p>The MSPDI file contains a <code>SaveVersion</code> attribute which indicates the version of Microsoft Project used to save the file. The value of <code>SaveVersion</code> is defined by the <code>net.sf.mpxj.mspdi.SaveVersion</code> enum, which provides the following values:</p>

<div class="source">
<div class="source"><pre class="prettyprint">Project2002
Project2003
Project2007
Project2010
Project2013
Project2016
</pre></div></div>

<p>By default <code>MSPDIWriter</code> sets the <code>SaveVersion</code> value to <code>Project2016</code>. The only functional difference this setting makes when writing MSPDI files is that the format of calendar exceptions changed in Project 2003 and onwards. MPXJ will always write calendar exceptions using the original Project 2002 format, and if the <code>SaveVersion</code> is set to <code>Project2003</code> or later it will also write the new format data as well.</p>
<p>Here&#x2019;s an example of the <code>SaveVersion</code> attribute being set to ensure that only the older style of calendar exceptions is written to the MSPDI file:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;
import net.sf.mpxj.mspdi.SaveVersion;
...

MSPDIWriter writer = new MSPDIWriter();
writer.setSaveVersion(SaveVersion.Project2002);
writer.write(projectFile, outputFileName);
</pre></div></div>
</section><section>
<h4><a name="Timephased_Data"></a>Timephased Data</h4>
<p>By default <code>MSPDIWriter</code> does not write timephased data to an MSPDI file. To enable writing timephased data, you can call the <code>setWriteTimephasedData</code> method.</p>
<p>When this setting is enabled, the default behaviour is for the timephased data is broken down into days when written to the file. If it better suits your use case (or you need a more compact file) you can choose to write an aggregated form of the timephased data by calling the <code>setSplitTimephasedAsDays</code> method and passing <code>false</code>. The difference between the two formats is that if for example you have a 10 day block with 8 hours work per day, this can either be represented as 10 entries in the file each for a single day with a value of 8 hours, or a single entry for a 10 day range with a value of 80 hours. Although the latter case is more compact, if you are consuming the MSPDI timephased data yourself you will need to differentiate between working an non-working days n order to break the single block down into smaller ranges. The default day-by-day format MPXJ writes does this for you automatically.</p>
<p>In the first example below we&#x2019;re enabling timephased data, and using the default day-by-dat breakdown:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;

...

MSPDIWriter writer = new MSPDIWriter();
writer.setWriteTimephasedData(true);
writer.write(projectFile, outputFileName);
</pre></div></div>

<p>In this second example we&#x2019;re overriding the default behaviour as asking MPXJ to write an aggregated form of the timephased data:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;

...

MSPDIWriter writer = new MSPDIWriter();
writer.setWriteTimephasedData(true);
writer.setSplitTimephasedAsDays(false);
writer.write(projectFile, outputFileName);
</pre></div></div></section></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2000&#x2013;2021
<a href="http://mpxj.org">Packwood Software</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
