<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MPXJ &#x2013; How To: Write MSPDI files</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-7202224-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
      </head>
    <body class="topBarDisabled">
                      <a href="https://github.com/joniles/mpxj">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>MPXJ</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2019-11-08</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">MPXJ</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a>  </li>
    <li><a href="changes-report.html" title="Changes"><span class="none"></span>Changes</a>  </li>
    <li><a href="getting-started.html" title="Getting started..."><span class="icon-chevron-right"></span>Getting started...</a>  </li>
    <li><a href="howto-read.html" title="How to read..."><span class="icon-chevron-right"></span>How to read...</a>  </li>
    <li><a href="howto-write.html" title="How to write..."><span class="icon-chevron-down"></span>How to write...</a>
      <ul class="nav nav-list">
    <li><a href="howto-write-mpx.html" title="MPX files"><span class="none"></span>MPX files</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>MSPDI files</a>
  </li>
      </ul>
  </li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a>  </li>
    <li><a href="users.html" title="Users"><span class="none"></span>Users</a>  </li>
    <li><a href="roadmap.html" title="Roadmap"><span class="none"></span>Roadmap</a>  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a>  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<div class="section">
<h2><a name="How_To:_Write_MSPDI_files"></a>How To: Write MSPDI files</h2>
<p>Since Microsoft Project 2002, Microsoft Project has been able to read and write an XML-based data interchange format called MSPDI.</p>
<div class="section">
<h3><a name="Writing_MSPDI_files"></a>Writing MSPDI files</h3>
<p>The sample code below illustrates how to write data to an MSPDI file.</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;

...

MSPDIWriter writer = new MSPDIWriter();
writer.write(projectFile, outputFileName);
</pre></div></div></div>
<div class="section">
<h3><a name="Using_MSPDIWriter"></a>Using MSPDIWriter</h3>
<div class="section">
<h4><a name="Save_Version"></a>Save Version</h4>
<p>The MSPDI file contains a <tt>SaveVersion</tt> attribute which indicates the version of Microsoft Project used to save the file. The value of <tt>SaveVersion</tt> is defined by the <tt>net.sf.mpxj.mspdi.SaveVersion</tt> enum, which provides the following values:</p>

<div class="source">
<div class="source"><pre class="prettyprint">Project2002
Project2003
Project2007
Project2010
Project2013
Project2016
</pre></div></div>
<p>By default <tt>MSPDIWriter</tt> sets the <tt>SaveVersion</tt> value to <tt>Project2016</tt>. The only functional difference this setting makes when writing MSPDI files is that the format of calendar exceptions changed in Project 2003 and onwards. MPXJ will always write calendar exceptions using the original Project 2002 format, and if the <tt>SaveVersion</tt> is set to <tt>Project2003</tt> or later it will also write the new format data as well.</p>
<p>Here&#x2019;s an example of the <tt>SaveVersion</tt> attribute being set to ensure that only the older style of calendar exceptions is written to the MSPDI file:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;
import net.sf.mpxj.mspdi.SaveVersion;
...

MSPDIWriter writer = new MSPDIWriter();
writer.setSaveVersion(SaveVersion.Project2002);
writer.write(projectFile, outputFileName);
</pre></div></div></div>
<div class="section">
<h4><a name="Timephased_Data"></a>Timephased Data</h4>
<p>By default <tt>MSPDIWriter</tt> does not write timephased data to an MSPDI file. To enable writing timephased data, you can call the <tt>setWriteTimephasedData</tt> method.</p>
<p>When this setting is enabled, the default behaviour is for the timephased data is broken down into days when written to the file. If it better suits your use case (or you need a more compact file) you can choose to write an aggregated form of the timephased data by calling the <tt>setSplitTimephasedAsDays</tt> method and passing <tt>false</tt>. The difference between the two formats is that if for example you have a 10 day block with 8 hours work per day, this can either be represented as 10 entries in the file each for a single day with a value of 8 hours, or a single entry for a 10 day range with a value of 80 hours. Although the latter case is more compact, if you are consuming the MSPDI timephased data yourself you will need to differentiate between working an non-working days n order to break the single block down into smaller ranges. The default day-by-day format MPXJ writes does this for you automatically.</p>
<p>In the first example below we&#x2019;re enabling timephased data, and using the default day-by-dat breakdown:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;

...

MSPDIWriter writer = new MSPDIWriter();
writer.setWriteTimephasedData(true);
writer.write(projectFile, outputFileName);
</pre></div></div>
<p>In this second example we&#x2019;re overriding the default behaviour as asking MPXJ to write an aggregated form of the timephased data: </p>

<div class="source">
<div class="source"><pre class="prettyprint">import net.sf.mpxj.ProjectFile;
import net.sf.mpxj.mspdi.MSPDIWriter;

...

MSPDIWriter writer = new MSPDIWriter();
writer.setWriteTimephasedData(true);
writer.setSplitTimephasedAsDays(false);
writer.write(projectFile, outputFileName);
</pre></div></div></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2000&#x2013;2019
<a href="http://mpxj.org">Packwood Software</a>.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>
